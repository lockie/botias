{% extends "layout.html" %}

{% macro table(id, row_headers) -%}
	<div id="{{ id }}"></div>
	<script type="text/javascript">
		$(function () {
		$("#{{ id }}").handsontable({
				startRows: {{ row_headers|length + 1 }},
				startCols: 4,
				cells: function (row, col, prop) {
					var cellProperties = {};
					cellProperties.readOnly = true;
					return cellProperties;
				},
				rowHeaders: {{ row_headers|tojson|safe }}
			});
		})
	</script>
	<br />

{%- endmacro %}

{% block title %} Results - Averagate! {% endblock %}
{% block head %}
	{{ super() }}
	<script type="text/javascript" src="/static/jquery-handsontable/jquery.handsontable.js"></script>
	<script type="text/javascript" src="/static/jquery-handsontable/lib/jQuery-contextMenu/jquery.contextMenu.js"></script>
	<script type="text/javascript" src="/static/jquery-handsontable/lib/jQuery-contextMenu/jquery.ui.position.js"></script>
	<link rel="stylesheet" media="screen" href="/static/jquery-handsontable/jquery.handsontable.css">

	<style type="text/css">
		th.htRowHeader {
			text-align:left;
			min-width: 500px;
			max-width: 500px;
		}
	</style>
{% endblock %}
{% block body %}
<script type=text/javascript>
	function displayError(jqXHR, exception) {
		$('#processing').hide();
		var err = "";
		if (jqXHR.status === -1) {
			err = jqXHR.responseText;
		} else if (jqXHR.status === 0) {
			err = "{{ _('Connection error. Contact administration.') }}";
		} else if (jqXHR.status == 404) {
			err = "{{ _('Page not found. Contact administration') }}";
		} else if (jqXHR.status == 500) {
			err = "{{ _('Internal server error. Contact administration.') }}"
		} else if (exception === 'parsererror') {
			err = "{{ _('Incorrect server response. Contact administration.') }}"
		} else if (exception === 'timeout') {
			err = "{{ _('Response timed out. Contact administration.') }}";
		} else if (exception === 'abort') {
			err = "{{ _('AJAX request aborted.') }}";
		} else {
			err = "{{ _('Unknown error: ') }}" + jqXHR.responseText + "{{ _('Contact administration.') }}";
		}
		$("#error").prepend(err);
		$('#error').show();
	}
	function queryResult(data) {
		if('error' in data) {
			displayError({responseText: data.error, status: -1}, "");
			return;
		}
		$.ajax({
			type: 'GET',
			url: '/_process',
			dataType: 'JSON',
			timeout: 1000,
			error: displayError,
			success: function(data) {
				if('error' in data) {
					displayError({responseText: data.error, status: -1}, "");
				} else {
					if(data.result==null) {
						setTimeout('queryResult({});', 1000);
					} else {
						$('#processing').hide();
						$("#table1").handsontable('loadData', data.result.t1);
						$("#table2").handsontable('loadData', data.result.t2);
						$("#table3").handsontable('loadData', data.result.t3);
						$("#table4").handsontable('loadData', data.result.t4);
						$("#table5").handsontable('loadData', data.result.t5);
						$("#table6").handsontable('loadData', data.result.t6);
						$("#table7").handsontable('loadData', data.result.t7);
						$("#table8").handsontable('loadData', data.result.t8);
						$("#table9").handsontable('loadData', data.result.t9);
						$("#tableA").handsontable('loadData', data.result.tA);
						$("#tableB").handsontable('loadData', data.result.tB);
						$("#tableC").handsontable('loadData', data.result.tC);
						$("#tableD").handsontable('loadData', data.result.tD);
						$("#tableE").handsontable('loadData', data.result.tE);
						$("#tableF").handsontable('loadData', data.result.tF);
						$("#tableS").handsontable('loadData', data.result.tS);
						$("#tableU").handsontable('loadData', data.result.tU);
						$("#tableV").handsontable('loadData', data.result.tV);
						$("#tableW").handsontable('loadData', data.result.tW);
						$("#tableX").handsontable('loadData', data.result.tX);
						$("#tableY").handsontable('loadData', data.result.tY);
						$("#tableZ").handsontable('loadData', data.result.tZ);
						$('#result').show();
					}
				}
			}
		});
	}
	$(document).ready(function() {
		$.ajax({
			type: 'POST',
			url: '/_process',
			data: 'id={{ id }}',
			dataType: 'JSON',
			error: displayError,
			success: queryResult
		});
	});
	</script>

	<div id="processing" class="container"><img src="/static/loader.gif" />{{ _('Processing data...') }}</div>
	<!-- TODO : more fancy progressbar -->

	<div id="error" class="container lead" style="display:none;">
		<br /><br /><a href='/office' class='btn btn-primary'>{{ _('Try again') }}</a>
	</div>

	<div id="result" class="container" style="display:none;">
	<h2>Результаты расчётов</h2>

	<!-- deloitte -->

	<h3>Пенсионные обязательства</h3>
	<ol>
		<li><h4>Планы с установленными взносами</h4>
		<blockquote>
			Пенсионные планы с установленными взносами (defined contribution pension plan) распространяются на сотрудников Предприятия, определенных пенсионными контрактами, заключенными работодателем с негосударственными пенсионными фондами. Участие Предприятия в указанных планах является добровольным и состоит в уплате работодателем пенсионных взносов в пользу работников, на условиях и в порядке, определенных пенсионными контрактами, коллективным договором и Законом Украины «О негосударственном пенсионном обеспечении». Активы указанных планов переданы негосударственным пенсионным фондам, участниками которых являются работники Предприятия, и отделены от остальных активов Предприятия. Работодатель имеет право прекратить, либо возобновить уплату взносов, или изменить их размер в зависимости от финансовых возможностей Предприятия, что, в свою очередь, не предусматривает каких-либо санкций (штрафов) со стороны работников, пенсионных фондов и государства.
		</blockquote>
		<blockquote>
			Общая сумма расходов по планам с установленными взносами, отраженных в консолидированном отчете[отчете о совокупном доходе/отчете о прибылях и убытках], в сумме 000,0 тыс. грн. (предыдущий год ─ 000,0 тыс. грн.) представляет собой сумму отчислений по пенсионным контрактам, заключенным Предприятием с негосударственными пенсионными фондами
			<small>МСФО 19.46</small>
		</blockquote>

		</li><li><h4>Планы с установленными выплатами</h4>
		<blockquote>
			Предприятие амортизирует актуарные прибыли и убытки, которые выходят за предел коридора, как указано в разделах 92 и 93 МСФО 19, на основе прямолинейного метода в течение ожидаемого среднего периода выхода на пенсию сотрудников, участвующих в плане.
			<small>МСФО 19.120A(a)</small>
		</blockquote>
		<blockquote>
			Предприятие участвует в государственном нефондированном пенсионном плане с установленными выплатами (state non-funded defined benefit pension plan). План учрежден в законодательном порядке и охватывает все расположенные в Украине компании, имеющие рабочие места, перечень которых определен Списком №1 и Списком №2 производств, работ, профессий, должностей и показателей, занятость на которых в течение определенного законом времени, дает право выхода на пенсию на льготных условиях, т.е. до наступления общегосударственного пенсионного возраста. В соответствии с планом сотрудники, являющиеся его участниками, имеют право на получение пенсий, назначаемых на льготных условиях (льготных пенсий) при условии выработки ими определенных законом минимальных сроков трудового (cтрахового) стажа и специального (по Спискам) стажа на предприятиях-участниках плана. Размер пенсий таких работников основывается на величинах их среднего заработка и средней заработной платы в Украине за весь период приобретения ими трудового (cтрахового) стажа и специального (по Спискам) стажа на предприятиях-участниках плана.
			<small>МСФО 19.120A(b)</small>
		</blockquote>
		<blockquote>
			Суммы ежемесячных пенсионных выплат рассчитываются для каждого пенсионера указанной категории по правилам и нормам законодательства Украины об общеобязательном государственном пенсионном страховании. Обязательство возникает в момент оформления работника на рабочее место, определенное Списком №1 (или Списком №2), и выполняется Предприятием путем возмещения Пенсионному фонду Украины (не подконтрольному Предприятию) фактических расходов на выплату и доставку льготных пенсий нынешним и бывшим работникам с момента назначения им такой пенсии до наступления у них общегосударственного пенсионного возраста (для мужчин – 60 лет, для женщин - 55 лет, если иной пенсионный возраст, не предусмотрен законодательством Украины).
		</blockquote>
		<blockquote>
			На Предприятии не предусмотрены какие-либо иные выплаты или льготы сотрудникам после их выхода не пенсию, связанные с достижением ими  определенного возраста или продолжением работы на Предприятии
		</blockquote>
		<blockquote>
			<div>Последние актуарные оценки активов плана и текущей стоимости обязательств по установленным выплатам производились 31 декабря 2011 года дипломированным актуарием В. В. Горенко. Приведенная стоимость обязательств по установленным выплатам и соответствующая стоимость услуг, оказанных Предприятия работниками в отчетном и прошлых годах, рассчитывались и отражались методом прогнозируемой условной единицы.</div>
			<div>У Предприятия недостаточно информации, чтобы осуществлять учет своей пропорциональной доли в обязательствах плана и затратах, связанных с возмещением Пенсионному фонду Украины расходов на выплату и доставку льготных пенсий другими предприятиями-участниками плана.</div>
			<div>Информация не может быть собрана в предыдущие периоды таким образом, чтобы было возможно ретроспективное применение новой учетной политики (включая ее перспективное применение к предыдущим периодам), а ретроспективный пересчет для корректировки ошибки предыдущего периода и восстановление информации практически невозможно.</div>
			<small>МСФО 8.50</small>
		</blockquote>
		<blockquote>
			Информация не может быть собрана в предыдущие периоды таким образом, чтобы было возможно ретроспективное применение новой учетной политики (включая ее перспективное применение к предыдущим периодам), а ретроспективный пересчет для корректировки ошибки предыдущего периода и восстановление информации практически невозможно.
		</blockquote>
		<blockquote>
			Основные допущения, использованные в актуарных оценках, приведены ниже.
			<small>МСФО 19.120A(n) </small>
		</blockquote>
		{{ table("tableZ", [
			"Ставка дисконтирования (средневзвешенная на отчетную дату)",
			"Ожидаемая доходность активов плана (в среднем за год)",
			"Ожидаемая ставка увеличения заработной платы (в среднем за год)",
			"Ожидаемая ставка увеличения пенсий (в среднем за год)",
			"Ожидаемая ставка инфляции (в среднем за год)",
			"Ожидаемая доходность прав на возмещение обязательств",
			"Смертность персонала",
			"Текучесть кадров"
		]) }}

		<blockquote>
			Суммы, отраженные в прибылях и убытках по пенсионным планам с установленными выплатами, представлены следующим образом.
			<small>МСФО 19.120A(g)</small>
		</blockquote>
		{{ table("tableY", [
			"Стоимость услуг отчетного года",
			"Стоимость процентов",
			"Ожидаемая доходность активов плана",
			"Ожидаемая доходность прав на возмещение обязательств",
			"Актуарные (прибыли)/убытки, признанные в течение года",
			"Стоимость услуг прошлых лет",
			"Убытки/(прибыли) от секвестра или расчета по плану",
			"Корректировки в связи с ограничениями, наложенными<br />на активы плана с установленными выплатами",
			""
		]) }}
		</li>
	</ol>

	<h4>Примечания к консолидированной финансовой отчетности за ??? год</h4>
	<blockquote>
		[Расходы по пенсионным планам за год включены в расходы на оплату труда в консолидированном [отчете о прибылях и убытках/ отчете о совокупном доходе].
		<small>МСФО 19.120A(g)</small>
	</blockquote>
	<blockquote>
		В консолидированном отчете о финансовом положении сумма обязательств по пенсионным планам с установленными выплатами представлена следующим образом.
		<small>МСФО 19.120A(f)</small>
	</blockquote>
	{{ table("tableX", [
		"Приведенная стоимость фондированных обязательств<br />пенсионных планов с установленными выплатами",
		"Справедливая стоимость активов планов",
		""
	]) }}
	<blockquote>
		Приведенная стоимость нефондированных обязательств пенсионных планов с установленными выплатами
		<small>МСФО 19.120A(d)</small>
	</blockquote>
	{{ table("tableW", [
		"Дефицит",
		"Непризнанные чистые актуарные прибыли (убытки)",
		"Непризнанная стоимость услуг прошлых лет",
		"Ограничения на признанные активы",
		"Справедливая стоимость прав возмещения обязательств,<br />признанная в качестве актива",
		"Прочее [указать]",
		"Чистые обязательства по планам с установленными выплатами",
		""
	]) }}
	<blockquote>
		Изменения приведенной стоимости обязательств планов с установленными выплатами представлены ниже.
		<small>МСФО 19.120A(c)</small>
	</blockquote>
	{{ table("tableV", [
		"Обязательства планов с установленными выплатами на начало года",
		"Стоимость услуг отчетного года ",
		"Стоимость процентов",
		"Взносы участников планов ",
		"Актуарные (прибыли)/убытки",
		"Стоимость услуг прошлых лет ",
		"Убытки/(прибыли) от секвестра планов",
		"Обязательства, прекращенные при расчете по планам",
		"Обязательства, принятые при сделках по объединению бизнесов",
		"Курсовые разницы по зарубежным планам",
		"Произведенные выплаты ",
		"Прочее [указать] ",
		"Обязательства планов с установленными выплатами на конец года"
	]) }}
	<blockquote>
		Изменения приведенной стоимости активов планов представлены следующим образом.
		<small>МСФО 19.120A(e)</small>
	</blockquote>
	{{ table("tableU", [
		"Справедливая стоимость активов планов на начало года ",
		"Ожидаемая доходность активов плана ",
		"Актуарные прибыли/(убытки)",
		"Курсовые разницы по зарубежным планам",
		"Взносы работодателя",
		"Взносы участников планов",
		"Произведенные выплаты",
		"Активы, приобретенные при сделках по объединению бизнесов",
		"Активы, распределенные при полном расчете по планам",
		"Прочее [указать]",
		"Справедливая стоимость активов планов на конец года"
	]) }}
	<blockquote>
		Основные категории активов планов и ожидаемые нормы доходности по каждой категории на конец отчетного года представлены следующим образом.
		<small>МСФО 19.120A(j),(l)</small>
	</blockquote>
	<!-- TODO : col/row span (jquery-handsontable issue 191) -->
	<!-- [
		"Ожидаемая норма доходности, %",
		"Ожидаемая норма доходности, %",
		"Справедливая стоимость активов плана, тыс.грн.",
		"Справедливая стоимость активов плана, тыс.грн."
	], -->
	{{ table("tableT", [
		"",
		"Долевые инструменты",
		"Долговые инструменты",
		"Недвижимость",
		"Прочее [указать]",
		"Средневзвешенная ожидаемая норма доходности"
	]) }}
	<blockquote>
		Активы планов к 31/12/??? не формировались.
		<small>МСФО 19.120A(k)</small>
	</blockquote>
	<blockquote>
		Ожидаемая норма доходности представляет собой средневзвешенное значение ожидаемых норм доходности по различным категориям активов планов. Оценка руководством ожидаемой доходности основана на данных прошлых лет и прогнозах рыночных цен на период исполнения пенсионных обязательств по оценкам аналитиков.
		<small>МСФО 19.120A(l)</small>
	</blockquote>
	<blockquote>
		Фактический доход по активам планов составил ??? тыс. грн. (??? год ─ ??? тыс. грн.).
		<small>МСФО 19.120A(m)</small>
	</blockquote>
	<blockquote>
		Корректировки активов и обязательств плана на основе опыта прошлых лет включают следующее.
		<small>МСФО 19.120A(p)</small>
	</blockquote>
	{{ table("tableS", [
		"Приведенная стоимость обязательств планов с установленными выплатами",
		"Справедливая стоимость активов планов",
		"Дефицит",
		"Корректировки обязательств планов на основе опыта прошлых лет",
		"Корректировки активов планов на основе опыта прошлых лет"
	]) }}
	<blockquote>
		В следующем году Предприятие планирует внести в программы с установленными выплатами взносы в сумме ??? тыс. грн.
		<small>МСФО 19.120A(q)</small>
	</blockquote>



	<!-- official --><br />

	<h3>Раскрытие информации</h3>
	{{ table("table1", [
		"1. Дисконтированная стоимость обязательств на начало",
		"2. Стоимость процентов",
		"3. Стоимость текущих услуг",
		"4. Стоимость прошлых услуг, из них: ; (5) + (6)",
		"5.  - гарантированные выплаты",
		"6.  - негарантированные выплаты",
		"7. Актуарная (прибыль) убыток от секвестров",
		"8. Произведенные выплаты",
		"9. Актуарная (прибыль) убыток от обязательств",
		"10. Дисконтированная стоимость обязательств на конец"
	]) }}
	{{ table("table2", [
		"1. Справедливая стоимость активов пенсионного плана на начало",
		"2. Ожидаемый доход на активы плана",
		"3. Фактический доход от активов",
		"4. Поступившие взносы",
		"5. Произведенные выплаты",
		"6. Актуарная (прибыль) убыток от активов",
		"7. Справедливая стоимость активов пенсионного плана на конец"
	]) }}
	{{ table("table3", [
		"1. Непризнанная актуарная прибыль (убыток) на начало",
		"2. Актуарная прибыль (убыток) от обязательств",
		"3. Актуарная прибыль (убыток) от активов",
		"4. Чистая прибыль (убыток) по состоянию на начало",
		"5. Актуарная прибыль (убыток), которая будет признана за год",
		"6. Непризнанная актуарная прибыль (убыток) на конец"
	]) }}
	{{ table("table4", [
		"1. Стоимость прошлых услуг, не признанных в балансе на начало",
		"2. Стоимость прошлых услуг, признаваемая в текущем периоде",
		"3. Стоимость прошлых услуг, не признанных в балансе на конец"
	]) }}
	{{ table("table5", [
		"1. Дисконтированная стоимость обязательств на конец",
		"2. Справедливая стоимость активов пенсионного плана на конец",
		"3. Большее из (1) и (2)",
		"4. 10% коридор",
		"5. Чистая накопленная непризнанная актуарная прибыль",
		"6. Превышение (5) по (4)",
		"7. Средняя продолжительность до выхода (лет)",
		"8. Амортизация прибыли (убытка), который будет признан в<br />следующем году начиная с 1-го января "
	]) }}

	<h3>Суммы, признаваемые в балансе</h3>
	<em>Активы (обязательства), признаваемые в балансе</em>
	{{ table("table6", [
		"1. Дисконтированная стоимость обязательств на конец",
		"2. Справедливая стоимость активов пенсионного плана на конец",
		"3. Финансовый результат [(дефицит) / профицит], (2) - (1)",
		"4. Непризнанная актуарная (прибыль) убытки",
		"5. Непризнанные обязательства прошлых периодов",
		"6. Чистые обязательства (активы), которые должны быть признаны на конец года"
	]) }}

	<em>Сумма в отчете о прибылях и убытках</em>
	{{ table("table7", [
		"1. Стоимость текущих услуг",
		"2. Стоимость процентов",
		"3. Ожидаемый доход на активы плана",
		"4. Признанный амортизационный убыток (прибыль)",
		"5. Стоимость прошлых услуг - гарантированные выплаты",
		"6. Стоимость прошлых услуг - негарантированные выплаты",
		"7. Результаты секвестров",
		"8. Расходы, признанные в составе отчета о прибылях и убытках"
	]) }}

	<h3>Актуарные предположения</h3>
	{{ table("table8", [
		"Ставка дисконтирования (средневзвешенная на отчетную дату)  ",
		"Ставка доходности активов плана (в среднем за год)",
		"Ставка увеличения заработной платы (в среднем за год)",
		"Ставка увеличения пенсий (в среднем за год)",
		"Ставка инфляции (в среднем за год)",
		"Смертность персонала",
		"Текучесть кадров",
	]) }}

	<h3>Раскрытия, связанные с ожидаемыми расходами, которые будут признаны в следующем году</h3>
	<!-- TODO : "Ожидаемая стоимость обязательств за год, начинающийся" - в заголовке -->
	{{ table("table9", [
		"Стоимость текущих услуг",
		"Стоимость процентов",
		"Ожидаемый доход на активы плана",
		"Признанный амортизационный убыток (прибыль)",
		"Стоимость прошлых услуг - гарантированные выплаты",
		"Стоимость прошлых услуг - негарантированные выплаты",
		"Результаты секвестров",
		"Расходы, признанные в составе отчета о прибылях и убытках"
	]) }}

	<h3>Дополнительная информация</h3>
	{{ table("tableA", [
		"Средняя заработная плата работников по Спискам, грн. в месяц",
		"Изменения заработной платы, в % к предыдущему году",
		"Общее количество работников (представленных в Анкете)",
		"Работников по Спискам (представленных в Анкете), в их числе:",
		"    - уже пенсионеры",
		"    - не достигнут пенсионных оснований",
		"    - уволились ранее (до начала года расчета)",
		"Работников по Спискам - Чернобыльцев"
	]) }}

	<em>Возрастное распределение работников по Спискам (представленных в Анкете):</em>
	{{ table("tableB", [
		"До 25 лет включительно",
		"Старше 25 лет – до 30 лет включительно",
		"Старше 30 лет – до 35 лет включительно",
		"Старше 35 лет – до 40 лет включительно",
		"Старше 40 лет – до 45 лет включительно",
		"Старше 45 лет – до 50 лет включительно",
		"Старше 50 лет – до 55 лет включительно",
		"Старше 55 лет – до 60 лет включительно",
		"Старше 60 лет"
	]) }}

	<em>Численность работников по Спискам на конец года:</em>
	{{ table("tableC", [
		"Работников по Списку №1 - мужчин",
		"Работников по Списку №2 - мужчин",
		"Работников по Списку №1 - женщин",
		"Работников по Списку №2 - женщин",
		"Всего:",
		"Справочно: предполагаемый коэффициент замещения заработка пенсией"
	]) }}

	<h3>Прочие долгосрочные вознаграждения</h3>
	<em>Вознаграждения к дате выхода на пенсию</em>
	{{ table("tableD", [
		"Период дисконтирования (лет)",
		"Количество всех предполагаемых выплат",
		"Приведенная стоимость всех вознаграждений, тыс. грн.",
		"Приведенная стоимость вознаграждений отчетного периода, тыс. грн.",
		"Выплаты в текущем году (план), тыс. грн.",
		"Предполагаемая стоимость выплат в следующем году, тыс. грн.",
	]) }}

	<em>Вознаграждения к юбилеям</em>
	{{ table("tableE", [
		"Период дисконтирования (лет)",
		"Количество всех предполагаемых выплат",
		"Приведенная стоимость всех вознаграждений, тыс. грн.",
		"Приведенная стоимость вознаграждений отчетного периода, тыс. грн.",
		"Выплаты текущем году (план), тыс. грн.",
		"Предполагаемая стоимость выплат в следующем году, тыс. грн.",
	]) }}

	<em>Вознаграждения за выслугу лет</em>
	{{ table("tableF", [
		"Период дисконтирования (лет)",
		"Количество всех предполагаемых выплат",
		"Приведенная стоимость всех вознаграждений, тыс. грн.",
		"Приведенная стоимость вознаграждений отчетного периода, тыс. грн.",
		"Выплаты в текущем году (план), тыс. грн.",
		"Предполагаемая стоимость выплат в следующем году, тыс. грн.",
		"Итоговая приведенная стоимость вознаграждений отчетного периода, тыс. грн.",
	]) }}


	</div>
{{ super() }}
{% endblock %}
